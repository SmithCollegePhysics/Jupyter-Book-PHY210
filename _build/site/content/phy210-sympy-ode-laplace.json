{"version":3,"kind":"Notebook","sha256":"990a1d71b04e5c4457151dd88db086daeaff01190dafb24604ef7a819a09b60a","slug":"phy210-sympy-ode-laplace","location":"/PHY210_Sympy_ODE_Laplace.ipynb","dependencies":[],"frontmatter":{"title":"Laplace Transforms","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"exports":[{"format":"ipynb","filename":"PHY210_Sympy_ODE_Laplace.ipynb","url":"/PHY210_Sympy_ODE_Lap-fa73edeb481fe247e14d9149d039197a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Laplace Transforms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wel4sygfIj"}],"identifier":"laplace-transforms","label":"Laplace Transforms","html_id":"laplace-transforms","implicit":true,"key":"xYtmHw1F5f"}],"key":"HtBxkBRJn4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# from sympy import laplace_initial_conds, inverse_laplace_transform","key":"LMYch5VtST"},{"type":"outputs","id":"iumHhlkxtwOlcGw7tSPQ8","children":[],"key":"FtucYOp1ia"}],"key":"E17DLn2gBm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PHY 210 Laplace Transform and Inverse Laplace Transform Notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ki1tLWkYya"}],"identifier":"phy-210-laplace-transform-and-inverse-laplace-transform-notebook","label":"PHY 210 Laplace Transform and Inverse Laplace Transform Notebook","html_id":"phy-210-laplace-transform-and-inverse-laplace-transform-notebook","implicit":true,"key":"BwV8bFcNsO"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Template for Solving Ordinary Differential Equations By Laplace Transform","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AXDX1323sS"}],"key":"M3Zg48vGrp"}],"key":"DQVQ2OgHF3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step 0: import needed Python tools","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VkTok4wfne"}],"identifier":"step-0-import-needed-python-tools","label":"step 0: import needed Python tools","html_id":"step-0-import-needed-python-tools","implicit":true,"key":"foHiNgH0nZ"}],"key":"xgD7vaVd1Y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"important standard packages by selecting cell and then clicking run button","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OxM163KHRj"}],"identifier":"important-standard-packages-by-selecting-cell-and-then-clicking-run-button","label":"important standard packages by selecting cell and then clicking run button","html_id":"important-standard-packages-by-selecting-cell-and-then-clicking-run-button","implicit":true,"key":"c6TXAvo9Wz"}],"key":"EcULdAMVmn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# import Numerical Python (NumPy)\nimport numpy as np\n\n# create a low-distraction space\nimport warnings\nwarnings.filterwarnings('ignore')","key":"AUxuGR0Ezj"},{"type":"outputs","id":"1vGs_FJHj_CnyiwMkEexU","children":[],"key":"Go5kcj3c8z"}],"key":"ogt5PjWHez"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# import Symbolic Python (SymPy)\n# from sympy import Function, dsolve, Derivative, checkodesol  (use this if you don't want to import the enire SymPy package) \nfrom sympy import * # Use the Symbolic Python (SymPy) package\nfrom sympy import init_printing # use LaTeX style typesetting of output\ninit_printing() # turn on typesetting ","key":"q8J4GE5j8X"},{"type":"outputs","id":"NwCXm3cDXc2KidAobE6U4","children":[],"key":"EnA8PP6Ddt"}],"key":"qBHuY3JGMJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%html\n<style>\ntable {float:left}\n</style>","key":"HXMGOg7WnN"},{"type":"outputs","id":"kIuj0zrA1lid1eeKVoYoy","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<style>\ntable {float:left}\n</style>\n","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"bY9XJUwSur"}],"key":"x94dPFUYOJ"}],"key":"gDokoU4G9x"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"now  import Laplace transform function and define symbols you will use","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DghKF0co7t"}],"identifier":"now-import-laplace-transform-function-and-define-symbols-you-will-use","label":"now  import Laplace transform function and define symbols you will use","html_id":"now-import-laplace-transform-function-and-define-symbols-you-will-use","implicit":true,"key":"tAaz1wo9fo"}],"key":"c0etqTsaHl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sympy import laplace_transform as L","key":"xtQG6wtiog"},{"type":"outputs","id":"PgU3smQwlj4iAeDIm_aST","children":[],"key":"vfaET5XMNf"}],"key":"uerwdzwkNx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# define independent variables and constants\nt = symbols('t',real=True)\ns = symbols('s',complex=True)\nb = symbols('b', real = True, positive=True) # constant\n\n# define dependent variables and functions\nx = Function('x')(t)\nX_s = symbols('X_s') \n\ny = Function('y')(t)\nY_s = symbols('Y_s')","key":"juEFpkOTVW"},{"type":"outputs","id":"jJP_1GA5eJLWktV-jVms6","children":[],"key":"B8VmeXOwRz"}],"key":"eu0B0Vl7iV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"run this cell to install code that allows you to specify initial conditions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M2EMaHIRUP"}],"identifier":"run-this-cell-to-install-code-that-allows-you-to-specify-initial-conditions","label":"run this cell to install code that allows you to specify initial conditions","html_id":"run-this-cell-to-install-code-that-allows-you-to-specify-initial-conditions","implicit":true,"key":"zp0Umfbo7L"}],"key":"GtiqxChJb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# run this cell to install code that allows you to specify initial conditions \n# this is a workaround we need to assign initial conditions \n# b/c laplace_initial_conds is missing from this Python installation on JupyterHub\n\ndef apply_initial_conditions(L,ic):\n    wf = Wild('f')\n    lw = LaplaceTransform(wf,t,s)\n    ll=L.find(lw)\n    for l in ll: \n        lz=l.match(lw)[wf]\n    newL = L\n    icl = [lz.diff(t,i).subs(t,0) for i in range(0,len(ic))]\n    for i in range(0,len(ic)):\n        newL = newL.replace(icl[i],ic[i])\n    return(newL)","key":"olfMIVATg1"},{"type":"outputs","id":"y3sC4TbWRGKnmwzflgoDN","children":[],"key":"rVnVHbNgBl"}],"key":"i2cZU68hmD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Homogeneous Differential Equations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SW9MB8bXT4"}],"identifier":"homogeneous-differential-equations","label":"Homogeneous Differential Equations","html_id":"homogeneous-differential-equations","implicit":true,"key":"gxf80msJ99"}],"key":"gdvH2dlWVH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step 1 create an expression for LHS of the ODE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HqN7UZWKoN"}],"identifier":"step-1-create-an-expression-for-lhs-of-the-ode","label":"step 1 create an expression for LHS of the ODE","html_id":"step-1-create-an-expression-for-lhs-of-the-ode","implicit":true,"key":"rxOXNv7f1J"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The expression below assumes you have a differential equation in terms of x(t) and its derivatives. Replace the expression below with your own expression.\nYou don’t need to specify that RHS = 0 since homogeneous.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EvDFOgba88"}],"key":"veWYo9XCpP"}],"key":"T2jV6OQoKr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# replace this expression with your own expression! \n# expression = x.diff(t,2)+9*x (leave this here for reference)\nexpression = x.diff(t,2)+9*x","key":"GIy39DdTsp"},{"type":"outputs","id":"YWAulKCD6HCdqRQ7XHtXE","children":[],"key":"JdWVS3Rzme"}],"key":"baQfRPuwZO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step 2 take the Laplace transform","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Aj9z4XD6JB"}],"identifier":"step-2-take-the-laplace-transform","label":"step 2 take the Laplace transform","html_id":"step-2-take-the-laplace-transform","implicit":true,"key":"eq0P1mmNKH"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This will give you an algebraic equation in terms of ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"F4oadvTl65"},{"type":"inlineMath","value":"s","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"eR4Spfv1Yt"},{"type":"text","value":" and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RIfPNa9K9F"},{"type":"inlineMath","value":"\\cal{L}\\left[{x(t)}\\right]","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mrow><mo fence=\"true\">[</mo><mrow><mi mathvariant=\"script\">x</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"script\">t</mi><mo stretchy=\"false\">)</mo></mrow><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\cal{L}\\left[{x(t)}\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\">L</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span></span></span></span></span>","key":"NDIiebmoKW"}],"key":"RZzkz0R072"}],"key":"LUkUa1xIOw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# take the Laplace transform of our homogeneous differential equation\nLaplace = laplace_transform(expression,t,s)[0]","key":"LINRWrvhCq"},{"type":"outputs","id":"Wg4Sl_vo0TKMg_uQfu-Op","children":[],"key":"rJINwEVg9R"}],"key":"FnuJNbctvE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  apply initial conditions [ x(0), x'(0) ] \nX = apply_initial_conditions(Laplace, [2, 5])\nX","key":"zbnrfBqj8p"},{"type":"outputs","id":"vdWqZeE8yV7HKwbXM-AMk","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bfc5fa6e44215d9be59fa0eacd74d620","path":"/bfc5fa6e44215d9be59fa0eacd74d620.png"},"text/latex":{"content":"$\\displaystyle s^{2} \\mathcal{L}_{t}\\left[x{\\left(t \\right)}\\right]\\left(s\\right) - 2 s + 9 \\mathcal{L}_{t}\\left[x{\\left(t \\right)}\\right]\\left(s\\right) - 5$","content_type":"text/latex"},"text/plain":{"content":" 2                                                                        \ns ⋅LaplaceTransform(x(t), t, s) - 2⋅s + 9⋅LaplaceTransform(x(t), t, s) - 5","content_type":"text/plain"}}},"children":[],"key":"yL9pBn6Sae"}],"key":"mg37ymYjaR"}],"key":"iBlAY0ub5M"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"now we want to rewrite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GckMqvBcQp"},{"type":"inlineMath","value":"\\cal{L}\\left[{x(t)}\\right]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mrow><mo fence=\"true\">[</mo><mrow><mi mathvariant=\"script\">x</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"script\">t</mi><mo stretchy=\"false\">)</mo></mrow><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\cal{L}\\left[{x(t)}\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\">L</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span></span></span></span></span>","key":"bgIPTDyJDP"},{"type":"text","value":" as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bDKnaYhCwy"},{"type":"inlineMath","value":"X(s)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"vobyayfjQ0"}],"key":"IJKJ4anZlc"}],"key":"d4CPIFrpuF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# write in more compact form\ntransformed_eq = X.subs(L(x,t,s, noconds=True), X_s)\ntransformed_eq","key":"zHF52QIpAu"},{"type":"outputs","id":"H903rj3swmdZRozm9YYb7","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9a3b5a9ad28e2c9a9be9c67aa7df44be","path":"/9a3b5a9ad28e2c9a9be9c67aa7df44be.png"},"text/latex":{"content":"$\\displaystyle X_{s} s^{2} + 9 X_{s} - 2 s - 5$","content_type":"text/latex"},"text/plain":{"content":"    2                 \nXₛ⋅s  + 9⋅Xₛ - 2⋅s - 5","content_type":"text/plain"}}},"children":[],"key":"omofktVthi"}],"key":"lCTxE6zsLf"}],"key":"nnXDF2JZni"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step 3 solve for X(s)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"REe43Yx6Ln"}],"identifier":"step-3-solve-for-x-s","label":"step 3 solve for X(s)","html_id":"step-3-solve-for-x-s","implicit":true,"key":"yHJ6nHKH7x"}],"key":"bNLMxxlcJe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# solve for X_s\nX_s_solution = solve(transformed_eq, X_s)[0]\nX_s_solution","key":"MKoFvNlhpD"},{"type":"outputs","id":"zDBCtXuIfB7suE165qbNG","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"034128cac9400044d0676864109a062c","path":"/034128cac9400044d0676864109a062c.png"},"text/latex":{"content":"$\\displaystyle \\frac{2 s + 5}{s^{2} + 9}$","content_type":"text/latex"},"text/plain":{"content":"2⋅s + 5\n───────\n 2     \ns  + 9 ","content_type":"text/plain"}}},"children":[],"key":"BKbbPJi1Gk"}],"key":"SOotrPLpU9"}],"key":"oUqwby7f3v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# now find inverse Laplace transform! \nresult=inverse_laplace_transform(X_s_solution, s, t)\nresult","key":"z5bwglb4hG"},{"type":"outputs","id":"b2HbRi2P8giJ0nCHI-1qI","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"36b52618f2286e30b44788d623ad7b0e","path":"/36b52618f2286e30b44788d623ad7b0e.png"},"text/latex":{"content":"$\\displaystyle \\left(\\frac{5 \\sin{\\left(3 t \\right)}}{3} + 2 \\cos{\\left(3 t \\right)}\\right) \\theta\\left(t\\right)$","content_type":"text/latex"},"text/plain":{"content":"⎛5⋅sin(3⋅t)             ⎞     \n⎜────────── + 2⋅cos(3⋅t)⎟⋅θ(t)\n⎝    3                  ⎠     ","content_type":"text/plain"}}},"children":[],"key":"UKmA66Jwjl"}],"key":"eaOfzaFLAH"}],"key":"oqrVO7tggt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step 4 take inverse Laplace transform of X(s) to find  x(t)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lxBeF8lJ7A"}],"identifier":"step-4-take-inverse-laplace-transform-of-x-s-to-find-x-t","label":"step 4 take inverse Laplace transform of X(s) to find  x(t)","html_id":"step-4-take-inverse-laplace-transform-of-x-s-to-find-x-t","implicit":true,"key":"OMFd12wb7J"}],"key":"FW3sxTHw99"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# note that $\\theta(t)$ is how SymPy writes the Heaviside step function ","key":"jPS7iSQbci"},{"type":"outputs","id":"iIVsEtF9s9Ai7aJ70r5eU","children":[],"key":"dW7WaqNEjC"}],"key":"HLFaWSD6cJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How to solve inhomogeneous equations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"chHMj6C6YJ"}],"identifier":"how-to-solve-inhomogeneous-equations","label":"How to solve inhomogeneous equations","html_id":"how-to-solve-inhomogeneous-equations","implicit":true,"key":"ljY1hyeTbn"}],"key":"PE9C9yVFP9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"z = Function('z')\n\n# The Laplace transform of z(t) is often represented as Z(s)\nZ = Function('Z')(s)\nZ_s = symbols('Z_s') \n\n# Define the differential equation\node = Eq(z(t).diff(t, 2) + 2*z(t).diff(t, 1) + 5*z(t), cos(2*t))\node","key":"V4f5di5AoP"},{"type":"outputs","id":"lifq5b11Oqh5kYd0dtJU3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c416debdf8c6f1318b5ed3f32383b4c1","path":"/c416debdf8c6f1318b5ed3f32383b4c1.png"},"text/latex":{"content":"$\\displaystyle 5 z{\\left(t \\right)} + 2 \\frac{d}{d t} z{\\left(t \\right)} + \\frac{d^{2}}{d t^{2}} z{\\left(t \\right)} = \\cos{\\left(2 t \\right)}$","content_type":"text/latex"},"text/plain":{"content":"                       2                  \n           d          d                   \n5⋅z(t) + 2⋅──(z(t)) + ───(z(t)) = cos(2⋅t)\n           dt           2                 \n                      dt                  ","content_type":"text/plain"}}},"children":[],"key":"B5qHDRBQw6"}],"key":"UmZj03chLV"}],"key":"iH97MNBrCC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply Laplace transform to both sides\ntransformed_lhs = laplace_transform(ode.lhs, t, s, noconds=True)\ntransformed_rhs = laplace_transform(ode.rhs, t, s, noconds=True)\n\n# Create the new algebraic equation in the Laplace domain\nlaplace_eq = Eq(transformed_lhs, transformed_rhs)\nprint(\"\\nTransformed equation in the s-domain (with unevaluated initial conditions):\")\n\nlaplace_eq\n","key":"iV9xmZimVT"},{"type":"outputs","id":"oU-gfodUWBwDbbhgrJ4nN","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\nTransformed equation in the s-domain (with unevaluated initial conditions):\n"},"children":[],"key":"PsWW9GJsrH"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2e437c9bc70c9a5d5902ee33996328b8","path":"/2e437c9bc70c9a5d5902ee33996328b8.png"},"text/latex":{"content":"$\\displaystyle s^{2} \\mathcal{L}_{t}\\left[z{\\left(t \\right)}\\right]\\left(s\\right) + 2 s \\mathcal{L}_{t}\\left[z{\\left(t \\right)}\\right]\\left(s\\right) - s z{\\left(0 \\right)} + 5 \\mathcal{L}_{t}\\left[z{\\left(t \\right)}\\right]\\left(s\\right) - 2 z{\\left(0 \\right)} - \\left. \\frac{d}{d t} z{\\left(t \\right)} \\right|_{\\substack{ t=0 }} = \\frac{s}{s^{2} + 4}$","content_type":"text/latex"},"text/plain":{"content":" 2                                                                             ↪\ns ⋅LaplaceTransform(z(t), t, s) + 2⋅s⋅LaplaceTransform(z(t), t, s) - s⋅z(0) +  ↪\n                                                                               ↪\n                                                                               ↪\n\n↪                                           ⎛d       ⎞│        s   \n↪ 5⋅LaplaceTransform(z(t), t, s) - 2⋅z(0) - ⎜──(z(t))⎟│    = ──────\n↪                                           ⎝dt      ⎠│t=0    2    \n↪                                                            s  + 4","content_type":"text/plain"}}},"children":[],"key":"xR6TFVaqBj"}],"key":"oPvQxHf0ii"}],"key":"rQlbp3xQFk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result= apply_initial_conditions(laplace_eq, [2, 5])\nprint(result)","key":"XsmcVl5wE3"},{"type":"outputs","id":"tdT41T1MxovRRssXKYZUk","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Eq(s**2*LaplaceTransform(z(t), t, s) + 2*s*LaplaceTransform(z(t), t, s) - 2*s + 5*LaplaceTransform(z(t), t, s) - 9, s/(s**2 + 4))\n"},"children":[],"key":"Hfa52LIjq8"}],"key":"prWx3gKvn4"}],"key":"fc9pYs8qfh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"toad = result.subs(LaplaceTransform(z(t), t, s), Z_s)","key":"hneXZCxMU4"},{"type":"outputs","id":"-IpVo1m8z1MwJWllfnrcO","children":[],"key":"hQSzO747D6"}],"key":"KWoIW28Fmb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Z_s_solution = solve(toad, Z_s)[0]\nZ_s_solution","key":"MOC51mG85g"},{"type":"outputs","id":"zMoiCoR3G3ydA4fxCG-J9","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"443bd39ebd7b8c36eec3121d44d0aa4f","path":"/443bd39ebd7b8c36eec3121d44d0aa4f.png"},"text/latex":{"content":"$\\displaystyle \\frac{2 s^{3} + 9 s^{2} + 9 s + 36}{s^{4} + 2 s^{3} + 9 s^{2} + 8 s + 20}$","content_type":"text/latex"},"text/plain":{"content":"     3      2              \n  2⋅s  + 9⋅s  + 9⋅s + 36   \n───────────────────────────\n 4      3      2           \ns  + 2⋅s  + 9⋅s  + 8⋅s + 20","content_type":"text/plain"}}},"children":[],"key":"csX6MHyEco"}],"key":"A6FZq0F3gh"}],"key":"T5HG3fJgyn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# if you are curious, you can try to use partial fractions to simplify the expression here\nZ_s_solution.apart(s)","key":"pteA5L90Lm"},{"type":"outputs","id":"Ob1hp_SrouQvXLJSnUzTN","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1ae38ce23d4a8b617b0354b3e96ee60d","path":"/1ae38ce23d4a8b617b0354b3e96ee60d.png"},"text/latex":{"content":"$\\displaystyle \\frac{s + 8}{17 \\left(s^{2} + 4\\right)} + \\frac{11 \\left(3 s + 13\\right)}{17 \\left(s^{2} + 2 s + 5\\right)}$","content_type":"text/latex"},"text/plain":{"content":"   s + 8        11⋅(3⋅s + 13)  \n─────────── + ─────────────────\n   ⎛ 2    ⎞      ⎛ 2          ⎞\n17⋅⎝s  + 4⎠   17⋅⎝s  + 2⋅s + 5⎠","content_type":"text/plain"}}},"children":[],"key":"einLgn4soY"}],"key":"dxKmGXqPhF"}],"key":"ofrmjkszyA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# now let's find the inverse laplace transform (if it exists!) ","key":"nY6r5hTpFP"},{"type":"outputs","id":"aZttrbspmiw3ClcHN3kaQ","children":[],"key":"sh4kYnH23X"}],"key":"EvjfU7fsUL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Z_t= inverse_laplace_transform(Z_s_solution, s, t)\nZ_t","key":"LlSY76xQRh"},{"type":"outputs","id":"Cg61DlPZLCEJCzVUmf-7S","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"810ac45d911300dc136a35c5815e2e49","path":"/810ac45d911300dc136a35c5815e2e49.png"},"text/latex":{"content":"$\\displaystyle \\left(\\frac{55 e^{- t} \\sin{\\left(2 t \\right)}}{17} + \\frac{33 e^{- t} \\cos{\\left(2 t \\right)}}{17}\\right) \\theta\\left(t\\right) + \\left(\\frac{4 \\sin{\\left(2 t \\right)}}{17} + \\frac{\\cos{\\left(2 t \\right)}}{17}\\right) \\theta\\left(t\\right)$","content_type":"text/latex"},"text/plain":{"content":"⎛    -t                -t         ⎞                                    \n⎜55⋅ℯ  ⋅sin(2⋅t)   33⋅ℯ  ⋅cos(2⋅t)⎟        ⎛4⋅sin(2⋅t)   cos(2⋅t)⎞     \n⎜─────────────── + ───────────────⎟⋅θ(t) + ⎜────────── + ────────⎟⋅θ(t)\n⎝      17                17       ⎠        ⎝    17          17   ⎠     ","content_type":"text/plain"}}},"children":[],"key":"jsM5xtOoZ0"}],"key":"suzqBcp8KK"}],"key":"FrgrZFolNC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Z_t.expand()","key":"MgbpQ9FMdj"},{"type":"outputs","id":"wCHah8OCMNBnoNK-uT-1t","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"56aa40d3282ac0ee0d7024785f7c82f3","path":"/56aa40d3282ac0ee0d7024785f7c82f3.png"},"text/latex":{"content":"$\\displaystyle \\frac{4 \\sin{\\left(2 t \\right)} \\theta\\left(t\\right)}{17} + \\frac{\\cos{\\left(2 t \\right)} \\theta\\left(t\\right)}{17} + \\frac{55 e^{- t} \\sin{\\left(2 t \\right)} \\theta\\left(t\\right)}{17} + \\frac{33 e^{- t} \\cos{\\left(2 t \\right)} \\theta\\left(t\\right)}{17}$","content_type":"text/latex"},"text/plain":{"content":"                                      -t                     -t              \n4⋅sin(2⋅t)⋅θ(t)   cos(2⋅t)⋅θ(t)   55⋅ℯ  ⋅sin(2⋅t)⋅θ(t)   33⋅ℯ  ⋅cos(2⋅t)⋅θ(t)\n─────────────── + ───────────── + ──────────────────── + ────────────────────\n      17               17                  17                     17         ","content_type":"text/plain"}}},"children":[],"key":"ADs3tGF6GZ"}],"key":"ZA6DcqIom7"}],"key":"hPlXLgu9f9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"success! remember that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fJz7lB82U5"},{"type":"inlineMath","value":"\\theta(t)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"D1DUeIZp7H"},{"type":"text","value":" is the Heaviside step function, so it equals 1 for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KyNuiy9C9b"},{"type":"inlineMath","value":"t \\ge 0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">t \\ge 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"L3vQVEwQ2h"},{"type":"text","value":".  We usually leave it out but here it is included to remind you that the transform assumes ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nSd9ONmqsr"},{"type":"inlineMath","value":"t>0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">t&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"sQMqysKnX9"},{"type":"text","value":" .","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cRLkpgyd9x"}],"key":"eb8erUGVEh"}],"key":"SGY6VtNiVu"}],"key":"gxgdjqOeHO"},"references":{"cite":{"order":[],"data":{}}}}